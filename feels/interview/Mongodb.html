<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>mongodb</title>
</head>
<body>
<pre>
    可使用原生的mongodbTemplate
    也可
    Query query = new Query();
    query.addCriteria(where("enInfoId").is(enInfoId).and("machineNo").is(machineNo));
    mongoTemplate.findOne(query , BillingPermission.class);

    分组查询：
        db.getCollection('invoiceOrder').aggregate([
        {
            "$match": {
                 "taxNo":"91440300MA5FJKHG7J",
                  "invoiceDate": {"$gte":ISODate("2020-04-01 00:00:00.964+08:00"),"$lte":ISODate("2020-04-14 23:00:00.964+08:00")},
            }
        },
        {
            "$group": {
                "_id": {"invoiceCode": "$invoiceCode", "invoiceNum": "$invoiceNum"},
                "count": {"$sum": 1}
            }
        },
        {
                "$match": {
                    "count": {"$gt": 1}
                }
        }
        ])

    mongo数据备份与恢复
    导出：
        建目录
        mongodump --port 27017 -d e9 -o /opt/e9_daochu/
        没有挂载，需要从docker中复制出来
        docker cp mongo:/opt/e9_daochu/e9/ /opt/

        导入：
        mongorestore -h dbhost -d dbname --dir dbdirectory
</pre>
</body>
</html>